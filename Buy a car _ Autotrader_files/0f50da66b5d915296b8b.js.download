(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{1355:function(e,t,r){(function(t){var r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/,o=/^\./,c=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,d=/\\(\\)?/g,l=/^\[object .+?Constructor\]$/,f="object"==typeof t&&t&&t.Object===Object&&t,v="object"==typeof self&&self&&self.Object===Object&&self,m=f||v||Function("return this")();var h,_=Array.prototype,y=Function.prototype,w=Object.prototype,O=m["__core-js_shared__"],x=(h=/[^.]+$/.exec(O&&O.keys&&O.keys.IE_PROTO||""))?"Symbol(src)_1."+h:"",j=y.toString,S=w.hasOwnProperty,k=w.toString,A=RegExp("^"+j.call(S).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),C=m.Symbol,D=_.splice,I=M(m,"Map"),P=M(Object,"create"),$=C?C.prototype:void 0,R=$?$.toString:void 0;function E(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function F(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function H(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function G(e,t){for(var r,n,o=e.length;o--;)if((r=e[o][0])===(n=t)||r!=r&&n!=n)return o;return-1}function N(object,path){for(var e,t=0,o=(path=function(e,object){if(z(e))return!1;var t=typeof e;if("number"==t||"symbol"==t||"boolean"==t||null==e||L(e))return!0;return n.test(e)||!r.test(e)||null!=object&&e in Object(object)}(path,object)?[path]:z(e=path)?e:W(e)).length;null!=object&&t<o;)object=object[B(path[t++])];return t&&t==o?object:void 0}function T(e){return!(!K(e)||(t=e,x&&x in t))&&(function(e){var t=K(e)?k.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?A:l).test(function(e){if(null!=e){try{return j.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function J(map,e){var t,r,data=map.__data__;return("string"==(r=typeof(t=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t)?data["string"==typeof e?"string":"hash"]:data.map}function M(object,e){var t=function(object,e){return null==object?void 0:object[e]}(object,e);return T(t)?t:void 0}E.prototype.clear=function(){this.__data__=P?P(null):{}},E.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},E.prototype.get=function(e){var data=this.__data__;if(P){var t=data[e];return"__lodash_hash_undefined__"===t?void 0:t}return S.call(data,e)?data[e]:void 0},E.prototype.has=function(e){var data=this.__data__;return P?void 0!==data[e]:S.call(data,e)},E.prototype.set=function(e,t){return this.__data__[e]=P&&void 0===t?"__lodash_hash_undefined__":t,this},F.prototype.clear=function(){this.__data__=[]},F.prototype.delete=function(e){var data=this.__data__,t=G(data,e);return!(t<0)&&(t==data.length-1?data.pop():D.call(data,t,1),!0)},F.prototype.get=function(e){var data=this.__data__,t=G(data,e);return t<0?void 0:data[t][1]},F.prototype.has=function(e){return G(this.__data__,e)>-1},F.prototype.set=function(e,t){var data=this.__data__,r=G(data,e);return r<0?data.push([e,t]):data[r][1]=t,this},H.prototype.clear=function(){this.__data__={hash:new E,map:new(I||F),string:new E}},H.prototype.delete=function(e){return J(this,e).delete(e)},H.prototype.get=function(e){return J(this,e).get(e)},H.prototype.has=function(e){return J(this,e).has(e)},H.prototype.set=function(e,t){return J(this,e).set(e,t),this};var W=U((function(e){var t;e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(L(e))return R?R.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(t);var r=[];return o.test(e)&&r.push(""),e.replace(c,(function(e,t,n,o){r.push(n?o.replace(d,"$1"):t||e)})),r}));function B(e){if("string"==typeof e||L(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function U(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],c=r.cache;if(c.has(o))return c.get(o);var d=e.apply(this,n);return r.cache=c.set(o,d),d};return r.cache=new(U.Cache||H),r}U.Cache=H;var z=Array.isArray;function K(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function L(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==k.call(e)}e.exports=function(object,path,e){var t=null==object?void 0:N(object,path);return void 0===t?e:t}}).call(this,r(34))},744:function(e,t,r){"use strict";r.r(t),r.d(t,"name",(function(){return x})),r.d(t,"state",(function(){return j})),r.d(t,"getters",(function(){return S})),r.d(t,"mutations",(function(){return k})),r.d(t,"actions",(function(){return A}));r(12),r(10);var n=r(39),o=(r(51),r(68),r(20),r(5),r(8),r(52),r(53),r(4),r(14),r(1)),c=r(2),d=(r(25),r(382),r(40),r(206)),l=r(255),f=r(1355),v=r.n(f),m=r(254),h=r.n(m),_=r(0);function y(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function w(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?y(Object(source),!0).forEach((function(t){Object(c.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):y(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var O=function(e,t){return e+t},x="advertisement",j=function(){return{id:null,adId:null,price:"",pickup_location:"",postcode:"",state:{name:""},status:"",liveAdPathAT:"",liveAdPathCG:"",description:"",insufficientEstimateData:!1,weekly_updates:!0,price_estimate:{from:0,to:0},termsConds:!1,views:[],searches:[],labels:[],savedOverallHealthScore:0,leads:0,completedSteps:[!1,!1,!1,!1,!1],opt_in_phone:1,source:"",ab_test:""}},S={getPriceEstimate:function(e){return e.price_estimate},getWordCount:function(e){return function(t){var r=e[t].match(/\S+/g);return r?r.length:0}},descriptionHealthScore:function(e,t){return Object(l.a)(t.getWordCount("description"))},overallHealthScore:function(e,t,r,n){return Object(l.d)(t.descriptionHealthScore,n["carDetails/detailsHealthScore"],n["photoGallery/imagesHealthScore"])},currentStepIdx:function(e){return e.completedSteps.findIndex((function(e){return!e}))},allFormStepsComplete:function(e){return e.completedSteps.slice(0,4).every((function(e){return e}))}},k={setField:function(e,t){var r=t.field,n=t.value;e[r]=n},setCurrentAd:function(e,t){var r=t.value;r.opt_in_phone?r.opt_in_phone=Number(r.opt_in_phone):r.opt_in_phone=0,Object.assign(e,w({},r))},resetAdvertisement:function(e){Object.assign(e,{id:null,adId:null,price:"",pickup_location:"",postcode:"",state:{name:""},status:"",liveAdPathAT:"",liveAdPathCG:"",description:"",insufficientEstimateData:!1,weekly_updates:!0,price_estimate:{from:0,to:0},termsConds:!1,views:[],searches:[],labels:[],savedOverallHealthScore:0,leads:0,completedSteps:[!1,!1,!1,!1,!1],opt_in_phone:1,source:"",ab_test:""})},completeStep:function(e,t){var r=t.index,n=t.value;_.default.set(e.completedSteps,r,n)}},A={fetchPriceEstimate:function(e){var t=this,r=e.rootState,n=e.commit;return Object(o.a)(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$platform.vehicles.v1.get("nvic-price/".concat(r.carDetails.nvic));case 3:(o=e.sent)&&n("setField",{field:"price_estimate",value:o.data.data}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),new Error(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},saveDraft:function(e){var t=this,r=e.state,n=e.getters,c=e.rootState,l=e.commit;e.dispatch;return Object(o.a)(regeneratorRuntime.mark((function e(){var o,f,data,v,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.getWordCount("description")<10&&l("completeStep",{index:3,value:!1}),o=h()(c.photoGallery.images),f=o.map((function(img){return img.tempImg&&delete img.tempImg,img})).filter((function(img){return 2===Number(img.status)})),e.prev=3,(data={ad:w({},r),car:w({},c.carDetails),images:w({},f)}).car.rego_exp="".concat(data.car.rego_exp),data.car.hasModifiedDetails="".concat(data.car.hasModifiedDetails),data.car.isCustom="".concat(data.car.isCustom),data.car.isGreyImport="".concat(data.car.isGreyImport),data.ad.completedSteps=data.ad.completedSteps.map((function(e){return"".concat(e)})),data.ad.savedOverallHealthScore=n.overallHealthScore,delete data.ad.id,delete data.ad.adId,delete data.ad.views,delete data.ad.searches,delete data.ad.labels,delete data.ad.termsConds,v={data:JSON.stringify(Object(d.a)(data))},!r.id){e.next=24;break}return e.next=21,t.$platform.identity.v1.put("user/draft-ads/".concat(r.id),v);case 21:m=e.sent,e.next=27;break;case 24:return e.next=26,t.$platform.identity.v1.post("user/draft-ads/",v);case 26:m=e.sent;case 27:if(!m){e.next=30;break}return r.id||l("setField",{field:"id",value:m.data.data.id}),e.abrupt("return",!0);case 30:e.next=35;break;case 32:throw e.prev=32,e.t0=e.catch(3),new Error(e.t0.message);case 35:case"end":return e.stop()}}),e,null,[[3,32]])})))()},loadDraft:function(e,t){var r=this;e.commit,e.rootState;return Object(o.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(t=r.$platform.identity.v1.get("user/draft-ads/${id}"))){e.next=4;break}return e.abrupt("return",Object(d.c)(t));case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),new Error(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))()},deleteDraft:function(e,t){var r=this,n=e.commit,c=t.id,d=t.index;return Object(o.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(t=r.$platform.identity.v1.delete("user/draft-ads/".concat(c)))){e.next=5;break}return n("ads/removeAd",{index:d,type:"drafts"},{root:!0}),e.abrupt("return",t);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),new Error(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},publishCurrentDraft:function(e){var t=this,r=(e.commit,e.state),n=e.rootState,c=e.dispatch;return Object(o.a)(regeneratorRuntime.mark((function e(){var o,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.ads.drafts.findIndex((function(e){return e.id===r.id})),e.prev=1,e.next=4,t.$platform.inventory.v1.post("inventory/private-party/".concat(r.id));case 4:if(!(d=e.sent)){e.next=8;break}return c("deleteDraft",{id:r.id,index:o}),e.abrupt("return",d.data);case 8:e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(1),new Error(e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})))()},updateAd:function(e){var t=this,r=(e.commit,e.state),n=e.getters,c=e.rootState;return Object(o.a)(regeneratorRuntime.mark((function e(){var o,data,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=h()(c.photoGallery.images),o.map((function(img){return img.tempImg&&delete img.tempImg,img})).filter((function(img){return 2===Number(img.status)})),e.prev=2,(data={ad:w({},r),car:w({},c.carDetails),images:w({},o)}).ad.savedOverallHealthScore=n.overallHealthScore,delete data.id,delete data.adId,delete data.views,delete data.searches,delete data.labels,l=Object(d.a)(data),e.next=13,t.$platform.inventory.v1.put("inventory/private-party/".concat(r.adId),{data:l});case 13:if(!e.sent){e.next=16;break}return e.abrupt("return",!0);case 16:e.next=21;break;case 18:throw e.prev=18,e.t0=e.catch(2),new Error(e.t0.message);case 21:case"end":return e.stop()}}),e,null,[[2,18]])})))()},deleteAd:function(e,t){var r=this,n=(e.commit,t.status),c=t.id;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.$platform.inventory.v1.delete("inventory/private-party/",{params:{status:n,id:c}});case 3:if(!e.sent){e.next=6;break}return e.abrupt("return",!0);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),new Error(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},relistAd:function(e,t){var r=this,n=(e.commit,t.id);return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.$platform.inventory.v1.post("inventory/private-party/relist/".concat(n));case 3:if(!e.sent){e.next=6;break}return e.abrupt("return",!0);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),new Error(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},setAdFromStore:function(e,t){var r=e.state,n=e.rootState,o=e.commit,c=e.dispatch,l=t.type,f=t.index,v=t.adId;o("ads/clearUpdates",null,{root:!0}),v&&(f=n.ads[l].findIndex((function(e){return e.id.toString()===v})));var m=w({},n.ads[l][f]),_={};if("ads"===l){var y=JSON.parse(m.private_party_meta);(_=Object(d.c)(w({},y))).id=m.source_ref_id,_.adId=m.id,_.status=m.status,_.liveAdPathAT=m.url,_.liveAdPathCG=m.url_cg,_.updatedSections&&delete _.updatedSections}else _=Object(d.c)(h()(m));var O=Object.keys(_.images).map((function(e){if(!_.images[e].thumbnail||!_.images[e].thumbnail_sm){var t=_.images[e].src.match(/(private-party-draft\/).*$/)[0],r="carsguide"===n.brand?"t_cg_listing_main":"t_listing_main";_.images[e].thumbnail="".concat("https://autotraderau-res.cloudinary.com","/").concat(r,"/").concat(t),_.images[e].thumbnail_sm="".concat("https://autotraderau-res.cloudinary.com","/").concat("t_cg_car_t","/").concat(t)}return _.images[e]}));o("advertisement/setField",{field:"state",value:{name:_.state.name}},{root:!0}),o("carDetails/setCarDetails",{carDetails:_.car},{root:!0}),o("photoGallery/setImages",O,{root:!0}),delete _.car,delete _.images,_.termsConds=!1,_.price_estimate={from:Number(_.price_estimate.from),to:Number(_.price_estimate.to)},_.savedOverallHealthScore=Number(_.savedOverallHealthScore),r.source&&(_.source?_.source.includes(r.source)||(_.source="".concat(_.source,",").concat(r.source)):_.source=r.source),o("setCurrentAd",{value:_}),n.carDetails.nvic&&c("carOptions/getFeatures",{},{root:!0})},clearCurrentAd:function(e){var t=e.state,r=e.commit,n=e.dispatch;r("setCurrentAd",{value:w({},{id:null,adId:null,price:"",pickup_location:"",postcode:"",state:{name:""},status:"",liveAdPathAT:"",liveAdPathCG:"",description:"",insufficientEstimateData:!1,weekly_updates:!0,price_estimate:{from:0,to:0},termsConds:!1,views:[],searches:[],labels:[],savedOverallHealthScore:0,leads:0,completedSteps:[!1,!1,!1,!1,!1],opt_in_phone:1,source:"",ab_test:""},{source:t.source})}),n("carDetails/clearCurrentCar",{},{root:!0}),n("photoGallery/clearCurrentPhotos",{},{root:!0})},getAdAnalytics:function(e,t){var r=this,c=e.commit,d=e.state,l=(e.rootState,e.dispatch,t.id),f=t.dateFrom,m=t.dateTo;return Object(o.a)(regeneratorRuntime.mark((function e(){var t,o,h,_,y,w,x,j;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.$platform.inventory.v1.get("inventory/private-party/stats",{params:{id:d.adId||l,dateFrom:f,dateTo:m,dataBy:"daily"}});case 2:return(t=e.sent)&&(o=v()(t,"data.data.data[0].views_detail",[]),h=v()(t,"data.data.data[1].views_detail",[]),_=v()(t,"data.data.data[0].views_search",[]),y=v()(t,"data.data.data[1].views_search",[]),w=[].concat(Object(n.a)(o),Object(n.a)(h)).reduce(O),x=[].concat(Object(n.a)(_),Object(n.a)(y)).reduce(O),c("setField",{field:"searches",value:x}),c("setField",{field:"views",value:w}),c("setField",{field:"labels",value:t.data.data.labels})),e.next=6,r.$axios.get("".concat("https://leads.platform.autotrader.com.au","/api/v1/leads/private-party/stats/").concat(d.adId));case 6:(j=e.sent)&&c("setField",{field:"leads",value:j.data.data.count});case 8:case"end":return e.stop()}}),e)})))()}}}}]);